{% extends "base.html" %}

{% block style %}

<style type="text/css">

.modo
{
    clear: left;
    font-size: 120%;
    margin-top: .75em;
    margin-bottom: .35em;
    background-color: #F5E754;
    padding: 8px;
}
label#subir
{
    display: inline-block;
    position: relative;
    background-color: #8DEDCD;
    color: #4B2B17;
    font-family: "Verdana";
    font-size: 100%;
    text-align: center;
    padding: 2px;
    width: 100px;
    border-radius: 4px;
    border-style: outset;
    border-color: black;
    border-width: 2px;
    cursor: pointer;
}
label:hover, label:active
{
    background-color: #4B2B17;
    color: #8DEDCD;
}
td.subir
{
    vertical-align: top;
    font-size: 100%;
    width: 125px;
}
td.ocultar
{
    text-align: right;
    font-size: 100%;
}
td.opciones
{
    font-size: 90%;
    font-style: italic;
    text-align: left;
}
.envoltorio-subida {
    position: relative;
    font-size: 100%;
}

.btn-subir {
    padding: 6px;
    width: 30%;
    position: absolute;
    left: 0;
    opacity: 0;
}
div.archivo {
    padding-top: 8px;
    padding-bottom: 8px;
    background-color: LightGray;
}
span.archivo {
    font-style: italic;
    color: #4B2B17;
}

div.archivo table td {
    vertical-align: middle;
    padding-left: 8px;
    padding-right: 18px;
}

div#fuente
{
    font-family: "Verdana";
    font-size: {% if props.tfuente %} {{props.tfuente}} {% else %} 120% {% endif %};
    font-weight: {% if documento %}normal{% else %}bold{% endif %};
    resize: none;
    padding: 8px 8px;
/* margin: 6px 0px 0px; */
    margin: 0px;
    box-sizing: border-box;
    width: 100%;
    height: {% if documento %}260pt{% else %}100pt{% endif %};
    white-space: normal;
    border: thin solid;
    overflow-y: auto;
}
span.fuente
{
    font-weight: bold;
}
div#meta
{
    font-family: "Verdana";
    font-size: {% if props.tfuente and not props.isdoc %} {{props.tfuente}} {% else %} 100% {% endif %};
    resize: none;
    padding: 8px 0px 8px 8px;
    line-height: 125%;
/*     margin: 6px 0px 0px; */
    margin: 0px;
    box-sizing: border-box;
    width: 100%;
    height: 100pt;
    white-space: normal;
    border: thin solid;
    overflow-y: auto;
}
div#doc
{
}
div.oradoc
{
}
div.oradoc:hover
{
    cursor: pointer;
    background-color: #8DEDCD;
}
span.lengua
{
    font-size: 120%;
    font-weight: bold;
}
div#instruc_fuente, div#instruc2, div#instruc_trad
{
    {% if props.ocultar %} display: none; {% endif %}
}
textarea.ometa
{
    font-family: "Verdana";
    resize: none;
    font-size: 100%;
    padding: 4px 0px 4px 4px;
    margin: 0px;
    width: 99%;
    border: thin solid;
    height: 100px;
}
textarea.dmeta
{
    font-family: "Verdana";
    resize: none;
    font-size: 100%;
    padding: 4px 0px 4px 4px;
    margin: 0px;
    width: 99%;
    border: thin solid;
    height: 120px;
}
input.filename
{
   width: 50pt;
}
div.despleg {
    font-family: "Verdana";
    background-color: #666666;
    color: white;
    font-size: 100%;
    padding-left: 5px;
    padding-right: 5px;
    padding-bottom: 2px;
    margin: none;
    border: none;
}
.opcion {
    font-size: 100%;
    cursor: pointer;
}
.desplegable {
    position: relative;
    display: inline-block;
}
.contenido-desplegable {
    display: none;
    position: absolute;
    background-color: #f1f1f1;
    min-width: 160px;
    overflow: auto;
    padding: 4px 4px;
    box-shadow: 0px 8px 16px 8px rgba(0,0,0,0.4);
    z-index: 1;
}
.show {display: block;}

</style>
{% endblock %}

{% block body %}

<table class='left'>

<form id='form' name="Form1" method=POST>

<tr class="brown">
    <td class="title">
    <a href="/">
    <img class='banner' src="{{url_for('static', filename='banner_logo.png')}}" alt="" width="300px"
      height="52px" />
    </a>
    </td>

    <td class="title" style="width: 100px"></td>

    <td class="menu" style="width: 200px">
      <input class="menu" type="submit" value="SALIR" name="salir" onclick="return alSalir();">
    </td>
    {% if user %}
    <td class="menuuser" style="width: 200px">{{ user }}</td>
    {% else %}
    <td class="menu" style="width: 200px">
       <button class="menu" onclick="ingresar()">IDENTIFICARTE</button>
    </td>
    {% endif %}
    <td class="menu" style="width: 200px"><button class="menu"
      onclick="mostrarAyuda();">AYUDA</button></td>
    <td class="menu" style="width: 200px"><a href="contacto">CONTACTO</a></td>

    <input type="hidden" name="ayuda" value="">
    <input type="hidden" name="modo" value="ora">
</tr>
</form>
<tr>
<td colspan="6">

<p id="error" class="error">
{% if error %}{{error}}{% endif %}
</p>

<form id="modo" name="Form0" method="post">
<div class="modo">
    <table style="width:100%">
    <tr>
    <td class='subir'>Traducción de </td>
    <td class='opciones'>
{% if doc %}
    <input type="radio" name="modo" id="ora" value="oración" onchange="this.form.submit();">palabra/frase/oración<br/>
    <input type="radio" name="modo" id="doc" value="documento" checked>documento
{% else %}
    <input type="radio" name="modo" id="ora" value="oración" checked>palabra/frase/oración<br/>
    <input type="radio" name="modo" id="doc" value="documento" onchange="this.form.submit();">documento
{% endif %}
    </td>
    <td class='ocultar'>
    <span id="ocultar" class="alternar" onclick="alternarInstrucciones();">
    {% if props.ocultar %}Mostrar instrucciones. {% else %}Ocultar instrucciones.{% endif %}
    </span>
    </td>
    </tr>
    </table>
</div>

{% if doc and not documento %}
<div class="envoltorio-subida" id="envoltorio-subida">
  <span class='instructions'>
    Subí un documento (formato .txt o .docx).
  </span>
  <label id="subir" for="subido">
  <div>Examinar...</div>
  <input id='subido' type='file' class="btn-subir" onchange="archivoSubido();" name='subido'>
  </label>
</div>
{% endif %}

<input type="hidden" name="documento" value=''>
<input type="hidden" name="ocultar" value={% if props.ocultar %} "true" {% else %} "false" {% endif %}>

</form>

{% if documento or not doc %}
<table class='left'>

  <tr>
    <td style="width: 590px">
      <span class="lengua">Castellano</span>
    </td>
    <td style="width: 20px"></td>
    <td style="width: 590px">
      <span class="lengua">Guaraní</span>
  </tr>

  <tr>
    <td>
  {% if documento %}
    <div id='fuente' contenteditable="false">{{documento|safe}}</div>
  {% elif oracion %}
    <div id='fuente' contenteditable="true">{{oracion|safe}}</div>
  {% else %}
    <div id='fuente' contenteditable="true"></div>
  {% endif %}<br class='instruc'/>

  {% if documento %}
    <div class="instruc" id="instruc_fuente">Para seleccionar una oración para traducir,
    hacé clic sobre la oración.</div>
  {% elif oracion %}
    <div class="instruc" id="instruc_fuente">Para traducir otra oración,
    primero presioná 'Borrar' o hacé clic en el espacio de arriba.
    </div>
    <br class='instruc'/>
    <input type="button" value="Borrar" id="button" onclick="borrar()">
  {% elif not doc %}
    <div class="instruc" id="instruc_fuente">Escribí una palabra,
    frase, u oración, y luego presioná Intro/Enter para traducirla.</div>
  {% endif %}
    </td>

    <td></td>

    <td>
      {% if doc %}
      <span class="level">Oración actual</span>
      {% endif %}
    <div id='meta'>
  {% if tra_seg_html %}
      {% for tra in tra_seg_html %}
      {{tra[2]|safe}}
      {% endfor %}
  {% endif %}
    </div>

    <br class='instruc'/>

  {% if tra %}
    <div class='instruc'>
    <div id='instruc2'>
    • Para segmentos marcados con "▾", pod&eacute;s seleccionar otra opción.<br />
    • Para cambiar la posición de un segmento, arrastralo sobre otro segmento.</div>
    </div>
    <br class="sep" />
    <span id="correccion" class="alternar" onclick="alternarCorreccion();">Desactivar corrección ortográfica automática.</span>
    <br class='instruc'/>
    <textarea class='ometa' id='textmeta'>{{tra|safe}}</textarea>
    <br class='instruc' />
    <div class="instruc" id="instruc_trad">
    • Si no estás satisfecho con la traducción, pod&eacute;s editarla.<br />
    {% if props.isdoc %}
    • Para incluir esta oración en la traducción del documento, presioná "Aceptar".<br />
    {% else %}
    • Para copiar la traducción al portapapeles, presioná "Copiar".<br />
    • Para registrar la traducción en la memoria de Mainumby, presioná "Registrar".
    {% endif %}
    </div>

    <br class='instruc'/>

    {% if props.isdoc %}
    <input type="button" value="Aceptar" id="button" onclick="aceptarTrad();">
    {% else %}
    <input type="button" value="Copiar" id="button" onclick="copiar();">
    <input type="button" value="Registrar" id="button" onclick="registrar();">
    {% endif %}

  {% endif %}

  {% if documento %}
    <br class="sep" />
    <span class="level">Documento</span><br />
    <form name="Form3" id="text-options">
    <textarea class='dmeta' id='aceptado'>{% if aceptado %}{{aceptado|safe}}{% endif %}</textarea>
    <br class='instruc' />
    <input type="submit" value="Guardar" id="button"/>
    <label>Nombre de archivo:<input type="text" class="filename" id="text-filename" placeholder="doc.txt" size="50"/></label>
    <input type="hidden" name="ocultar" value={% if props.ocultar %}"true"{% else %}"false"{% endif %}>
    </form>
  {% endif %}
    </td>
  </tr>

</table>
{% endif %}

<form name="Form2" method=POST action='tra'>
<input type="hidden" name="ofuente" value="">
<input type="hidden" name="oindex" value={% if oindex %}{{oindex}}{% else %}"0"{% endif %}>
<input type="hidden" name="tacept" value="">    
<input type="hidden" name="isdoc" value=false>
<input type="hidden" name="borrar" value=false>
<input type="hidden" name="registrar" value=false>
<input type="hidden" name="tfuente" value="120%">
<input type="hidden" name="ometa" value="">
<input type="hidden" name="nocorr" value="">
<input type="hidden" name="ocultar" value={% if props.ocultar %}"true"{% else %}"false"{% endif %}>
<input type="hidden" name="docscrolltop" value=0>
</form>

{% endblock %}

{% block script %}

{% if doc and not documento %}
<script src="{{url_for('static', filename='mammoth.browser.js')}}"></script>
{% endif %}

{% if aceptado %}
<script async="" src="{{url_for('static', filename='FileSaver.js')}}"></script>
<script async="" src="{{url_for('static', filename='Blob.js')}}"></script>
<script async="" src="{{url_for('static', filename='SaveDoc.js')}}"></script>
{% endif %}

{% if docscrolltop %}
<script>
document.getElementById("fuente").scrollTop = {{docscrolltop}};
</script>
{% endif %}
 
<script>
document.getElementById("fuente").focus();

// Detectar nueva línea (Intro) en el espacio 'fuente' para iniciar traducción.
document.getElementById("fuente").addEventListener("keypress", function(event) {
   key = event.which || event.keyCode;
   longFuente();
   if (key == 13) {
       event.preventDefault();
       fuenteNuevaLinea();
   }
});

// Detectar ediciones del espacio 'textmeta' para corregir errores ortográficos.
document.getElementById("textmeta").addEventListener("keyup", function(event) {
    if (!document.Form2.nocorr.value) {
	key = event.key;
	code = event.which || event.keyCode;
        if (code > 47 && code != 224) {
	    corregirGn();
	}
    }
});

{% if not doc %}
document.getElementById("fuente").addEventListener("click", function(event) {
    if (document.getElementById("textmeta").value) {
        borrar();
    }
});
{% endif %}

function getDocScrollTop()
{
    var doc = document.getElementById("fuente");
    var y = doc.scrollTop;
    return y;
}

function longFuente()
{
    f = document.getElementById("fuente");
    t = f.innerHTML;
    t = t.replace(/<br>/g, "");
    l = t.length;
    if (l > 40) {
        f.style.fontSize = "115%";
        document.Form2.tfuente.value = "115%";
    }
}

function alSalir()
{
    document.Form2.borrar.value = 'true';
    document.Form2.ofuente.value = '';
    document.Form2.tfuente.value = "120%";
    document.Form1.action = "fin";
    document.Form1.target = "_self";     // Misma ventana
    document.Form1.submit();             // Enviar la página
    return true;
}

function borrarFuente() {
    document.getElementById("fuente").innerHTML = "";
}

function borrar()
{
    document.Form2.borrar.value = 'true';
    document.Form2.ofuente.value = '';
    document.Form2.tfuente.value = "120%";
    document.Form2.submit();
    return true;
}

function copiar()
{
    textmeta = document.getElementById("textmeta");
    textmeta.select();
    document.execCommand("copy");
}

function registrar()
{
    meta = document.getElementById("textmeta").value;
    document.Form2.ometa.value = meta;
    document.Form2.borrar.value = 'true';
    document.Form2.registrar.value = 'true';
    document.Form2.tfuente.value = "120%";
    document.Form2.action = "tra";
    document.Form2.submit();
}

function aceptarTrad()
{
    trad = document.getElementById("textmeta").value;
    document.getElementById("aceptado").value = '';
    index = document.Form2.oindex.value;
//    alert("Aceptando oración " + index + " :: " + trad);
    document.Form2.tacept.value = trad;
    document.Form2.isdoc.value = "true";
    document.Form2.tfuente.value = "100%";
    document.Form2.submit();
}

function mayuscula(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

function agregarTri(string) {
    return string + " \u25BE";
}

function eliminarTri(string) {
    return string.replace(/ \u25BE/g, '');
}

function limpiarMeta(string) {
    // Remove line breaks.
    string = string.replace(/(\r\n|\n|\r)/gm, "");
    string = string.trim();
    // Convert non-breaking spaces to spaces.
    string = string.replace(/\&nbsp;/g, ' ');
    // Remove menu triangle.
    string = string.replace(/ \u25BE/g, '');
    // Remove extra spaces
    string = string.replace(/\s+/g," ");
    // Remove spaces before periods, commas, and semicolons
    string = string.replace(/ \./g, ".");
    string = string.replace(/ \,/g, ",");
    string = string.replace(/ \;/g, ";");
    string = string.replace(" ?", "?");
    {% if props.cap %}
    string = mayuscula(string);
    {% endif %}
    return string;
}

function corregirGn() {
    textmeta = document.getElementById("textmeta");
    text = textmeta.value;
    if (text) {
	position = textmeta.selectionStart;
	// Where to put the cursor after correction.
	insertion = position;
        changed = '';
        c = text.slice(position-1, position);
//	alert("char " + c + " before " + before + " after " + after);
        if (["â", "ä"].indexOf(c) >= 0) {
	    changed = "ã";
        } else if (["ê", "ë"].indexOf(c) >= 0) {
	    changed = "ẽ";
        } else if (["î", "ï"].indexOf(c) >= 0) {
	    changed = "ĩ";
        } else if (["ô", "ö"].indexOf(c) >= 0) {
	    changed = "õ";
        } else if (["û", "ü"].indexOf(c) >= 0) {
	    changed = "ũ";
        } else if (["ŷ", "ÿ"].indexOf(c) >= 0) {
	    changed = "ỹ";
        } else if ("ĝ" == c) {
	    changed = "g̃";
	    // Two characters so insert character one position forward.
	    insertion += 1;
	} else if (["`", "´", "°", "‘", "'", "ʼ"].indexOf(c) >= 0) {
	    changed = "’";
	}
	if (changed) {
	    before = text.slice(0, position-1);
	    after = text.slice(position);
	    text = before + changed + after;
	    document.getElementById("textmeta").value = text;
	    textmeta.selectionEnd = insertion;
	}
    }
}

function fuente() {
    f = document.getElementById("fuente").innerHTML;
    // May contain <br>
    f = f.replace(/<br>/g, "");
    return f;
}

function fuenteNuevaLinea() {
    f = fuente();
    document.getElementById("fuente").innerHTML = f;
    document.Form2.ofuente.value = f;
    document.Form2.action = "tra";
    document.Form2.submit();
}

function cambiarMeta(button, choiceid) {
    newitem = document.getElementById(choiceid).innerHTML;
    olditem = document.getElementById(button).innerHTML;
    // Add and remove the menu dropdown triangle.
    newitem = agregarTri(newitem);
    olditem = eliminarTri(olditem);
    document.getElementById(button).innerHTML = newitem;
    document.getElementById(choiceid).innerHTML = olditem;
    actualTra();
}

/* What happens when the user clicks on a sentence in the document window.*/
function seleccionarOra(oraid, index) {
    var oracion = document.getElementById(oraid).innerHTML;
    var scrolltop = getDocScrollTop();
    document.Form2.docscrolltop.value = scrolltop;
//    alert("Scrolltop " + scrolltop);
    document.Form2.ofuente.value = oracion;
    document.Form2.oindex.value = index;
    document.Form2.tfuente.value = "100%";
    document.Form2.isdoc.value = "true";
    document.Form2.submit();
}

/* When the user clicks on the button, toggle between hiding and showing the dropdown content */
function desplegar(button) {
    element = document.getElementById(button);
    document.getElementById(button).classList.toggle("show");
}

/* Encuentra las traducciones de segmentos actualmente seleccionados */
function actualTra() {
    var trans = "";
    var dropdowns = document.getElementsByClassName("despleg");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var dropdown = dropdowns[i];
      var trans1 = dropdown.innerHTML;
      trans = trans + " " + trans1;
    }
    trans = limpiarMeta(trans);
    document.getElementById('textmeta').value = trans;
    document.Form2.tmeta.value = trans;
}

function ingresar() {
    form = document.getElementById("form");
    form.action = "login";
    form.submit();
}

/* Alternar corrección automática */
function alternarCorreccion() {
//    alert("Alternando " + document.Form2.nocorr.value);
    if (document.Form2.nocorr.value) {
//	alert("Activando...");
	document.Form2.nocorr.value = "";
        document.getElementById('correccion').innerHTML = "Desactivar corrección ortográfica automática.";
    } else {
//	alert("Desactivando...");
	document.Form2.nocorr.value = "true";
        document.getElementById('correccion').innerHTML = "Activar corrección ortográfica automática.";
    }
}

/* Alternar ocultar instrucciones */
function alternarInstrucciones() {
    var f;
    if (document.Form0.ocultar.value == "false") {
//	alert("Hiding instructions");
	document.Form0.ocultar.value = "true";
	document.Form2.ocultar.value = "true";
	if (document.Form3) {
	    document.Form3.ocultar.value = "true";
	}
	document.getElementById("ocultar").innerHTML = "Mostrar instrucciones.";
	f = document.getElementById("instruc_fuente");
	if (f) {
	    f.style.display = "none";
	}
	f = document.getElementById("instruc2");
	if (f) {
	    f.style.display = "none";
	}
	f = document.getElementById("instruc_trad");
	if (f) {
	    f.style.display = "none";
	}
    } else {
//	alert("Showing instructions");
	document.Form0.ocultar.value = "false";
	document.Form2.ocultar.value = "false";
	if (document.Form3) {
	    document.Form3.ocultar.value = "false";
	}
	document.getElementById("ocultar").innerHTML = "Ocultar instrucciones.";
	f = document.getElementById("instruc_fuente");
	if (f) {
	    f.style.display = "block";
	}
	f = document.getElementById("instruc2");
	if (f) {
	    f.style.display = "block";
	}
	f = document.getElementById("instruc_trad");
	if (f) {
	    f.style.display = "block";
	}
    }
}

// Buscar archivo subido y mostrar su nombre.
function archivoSubido() {
    borrarError();
    var uploaded = document.getElementById("subido");
    if (uploaded) {
	var files = uploaded.files;
	if (files) {
	    var file = files[0];
	    var size = file.size;
	    size = size / 1000;
	    if (!file.type.match('text.*')) {
		if (file.type == "application/vnd.openxmlformats-officedocument.wordprocessingml.document") {
		    mostrarDocxSubido(file, size);
		    return true;
		} else {
		    error("¡" + file.name + " no es un archivo de texto válido! (tipo " + file.type + ")");
		    return false;
		}
	    } else if (size > 500) {
		error("¡" + file.name + " es demasiado grande para Mainumby! Por favor subí otro archivo más pequeño.");
		return false;
	    }
	    mostrarArchivoSubido(file, size);
	}
    }
    return true;
}

function mostrarDocxSubido(file, size) {
    // Use mammoth to extract text from docx file.
    var name = file.name;
    var r = new FileReader();
    r.onload = function(e) {
	var arrayBuffer = e.target.result;
//	mammoth.convertToHtml({arrayBuffer: arrayBuffer})
	mammoth.extractRawText({arrayBuffer: arrayBuffer})
	    .then(mostrarContenido)
	    .done();
    };
    r.readAsArrayBuffer(file);
    mostrarInfoArchivo(name, size);
}

function mostrarInfoArchivo(name, size) {
    var html = "<div class='archivo'><table><tr><td class='archivo'><span class='heading'>Archivo subido</span></td><td class='archivo'><span class='archivo'>" + name + "</span><br/>" + size +
	" KB</td><td class='archivo'><button id='button' type='button' onclick='procDoc();'>Abrir</button></td></tr></table></div>";
    document.getElementById('envoltorio-subida').innerHTML = html;
}

function mostrarContenido(result) {
    contenido = result.value;
    document.Form0.documento.value = contenido;
}

// Mostrar el nombre de un archivo subido y un botón para abrirlo.
function mostrarArchivoSubido(file, size) {
    var name = file.name;
    var r = new FileReader();
    r.onload = function(e) {
	contenido = e.target.result;
	document.Form0.documento.value = contenido;
    }
    r.readAsText(file);
    mostrarInfoArchivo(name, size);
}

// Leer el contenido de un archivo subido y guardarlo en la variable documento.
function procDoc() {
//    var text = document.Form0.documento.value;
    document.Form0.submit();
    return true;
}

/* Drag and drop translation buttons */
function allowDrop(ev) {
    ev.preventDefault();
}
function drag(ev) {
//    ev.preventDefault();
    ev.dataTransfer.effectAllowed = "move";
    ev.dataTransfer.setData("text/plain", ev.target.id);
}
function drop(ev) {
    ev.preventDefault();
    var src = document.getElementById(ev.dataTransfer.getData("text/plain"));
    var srcParent = src.parentNode;
    var tgt = ev.currentTarget.firstElementChild;
    ev.currentTarget.replaceChild(src, tgt);
    srcParent.appendChild(tgt);
    // Update the sentence in the ometa textbox
    actualTra();
}

function mostrarAyuda() {
    var helpWin = window.open("", "Mainumby: Ayuda",
			      "titlebar=yes,scrollbars=yes,status=no,top=200,left=200,width=700,height=400");
    helpWin.document.write(
'<html>\
<head>\
<link rel="stylesheet" type=text/css href={{url_for("static", filename="style.css")}}/>\
<title>Mainumby: Ayuda</title>\
</head>\
<body>\
<h4 class="help">Ayuda para usar el traductor</h4>\
<p class="help">En esta página se puede traducir palabras, frases, \
oraciones simples, y documentos almacenados en archivos. \
</p>\
<h5 class="help">Instrucciones para palabras, frases, y oraciones</h5>\
<ol class="help">\
  <li>Introducí una palabra, frase, u oración en el espacio a la \
  izquierda. \
  </li>\
  <li>Presioná la tecla Intro/Enter.\
  </li>\
  <li>La visualización de la oración cambia para mostrar los segmentos \
  extraídos por Mainumby con colores diferentes. \
  La traducción de Mainumby aparece en los espacios a la derecha. \
  El superior muestra la traducción de los segmentos extraídos por \
  Mainumby,  con colores que corresponden a los de los segmentos en la \
  oración castellana. \
  </li>\
  <li>\
  Si un segmento tiene el símbolo "▾", podés escoger otra traducción \
  de la lista que aparece cuando hacés clic en el segmento. \
  </li>\
  <li>\
  Podés cambiar la posición de los segmentos al arrastrar un \
  segmento con el mouse y soltarlo sobre otro segmento. \
  </li>\
  <li>\
  La traducción que corresponde a las opciones seleccionadas se \
  muestra en el espacio inferior a la derecha. \
  Si todavía no estás satisfecho con la traducción, podés editar el \
  texto en este espacio. \
  Mainumby normaliza los caracteres guaraníes que escriben en este \
  espacio, por ejemplo, cambiando "ê" a "ẽ". \
  Si no te gusta esta función, podés desactivarla al hacer clic en \
  "Desactivar corrección ortográfica automática." \
  </li>\
  <li>Para copiar la traducción al portapapeles de tu computadora o \
  teléfono para pegarla en otra ventana, presioná el botón "Copiar". \
  </li>\
  <li>Para registrar la traducción en la memoria de traducción de \
  Mainumby (así mejorando traducciones futuras que ofrece el sistema), \
  presioná el botón "Registrar". \
  </li>\
  </ol>\
<h5 class="help">Instrucciones para documento</h5>\
<ol class="help">\
  <li>En el espacio amarillo en la parte superior de la página, \
  seleccioná "Documento". \
  </li>\
  <li>Presioná el botón "Examinar..." para subir un documento de tu \
  computadora o telefóno. Aparecerá una nueva ventana en la que podés \
  escoger un archivo. Ten en cuenta que Mainumby maneja solo archivos \
  de formato .txt (o sea, archivos de texto) y de formato .docx (o \
  sea, archivos de Microsoft Word 2007 o posterior). Además los \
  archivos de más de 1 MB no se manejan. \
  </li>\
  <li>\
  Una vez que has escogido un archivo admisible, verás en un espacio \
  gris el nombre y el tamaño del archivo. Presioná el botón "Abrir" \
  para continuar con la traducción de este archivo. \
  </li>\
  <li>\
  Manumby segmenta el documento en oraciones, mostrando los límites \
  entre párrafos con el simbolo "¶". \
  Aparte de eso, descarta el formato del documento, por ejemplo, las \
  fuentes y la sangría.\
  </li>\
  <li>Seleccionás oraciones para traducir al mover el mouse sobre el \
  documento. Para traducir la oración resaltada en negrita, hacé \
  clic. \
  </li>\
  <li>Como en la interfaz para oraciones, se muestran los segmentos \
  extraídos por Mainumby y sus traducciones (a la derecha) con \
  colores. Como en la otra interfaz, se puede escoger entre las \
  opciones ofrecidas y cambiar la posición de segmentos. \
  </li>\
  <li>Cuando estés satisfecho con la traducción de la oración, \
  presioná el botón "Aceptar" para incluirla en la traducción del \
  documento, la que se muestra en el espacio en la parte inferior \
  derecha.\
  </li>\
  <li>Cuando termines la traducción del documento, lo podés \
  guardar como archivo en tu computadora o teléfono. Escribí un nombre \
  para el archivo en el espacio después de "Nombre de archivo:", y \
  presioná el botón "Guardar". \
  El archivo será de formato ".txt" (texto), no de ".docx" (Microsoft \
  Word).\
  </li>\
</ol>\
</body></html>'
);
    document.Form1.ayuda.value = true;
}
</script>

{% endblock %}
